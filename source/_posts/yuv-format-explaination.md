---
title: YUV 格式详解
date: 2018-12-10 20:19:23
tags: Android音视频
---

YUV 与 RGB 类似，都属于颜色的编码方式。

首先介绍一下 RGB 格式。

## RGB 编码

RGB 分别表示红（R）、绿（G）、蓝（B），也就是三原色，将它们以不同的比例叠加，可以产生不同的颜色。

比如一张 1920 * 1280 的图片，代表着有 1920 * 1280 个像素点。如果采用 RGB 编码方式，每个像素点都有红、绿、蓝三个原色，其中每个原色占用 8 个字节，每个像素占用 24 个字节。

那么，一张 1920 * 1280 大小的图片，就占用 1920 * 1280 * 3 / 1024 / 1024 = 7.03 MB 存储空间。

## YUV 编码

YUV 编码采用了明亮度和色度表示每个像素的颜色。

其中 Y 表示明亮度（Luminance、Luma），也就是灰阶值。

U、V 表示色度（Chrominance 或 Chroma），描述的是色调和饱和度。

YCbCr 其实是 YUV 经过缩放和偏移的翻版。其中 Y 与 YUV 中的 Y 含义一致,Cb,Cr 同样都指色彩，只是在表示方法上不同而已。YCbCr 其中 Y 是指亮度分量，Cb 指蓝色色度分量，而 Cr 指红色色度分量。

## YUV 优点

对于 YUV 所表示的图像，Y 和 UV 分量是分离的。如果只有 Y 分量而没有 UV 分离，那么图像表示的就是黑白图像。彩色电视机采用的就是 YUV 图像，**解决与和黑白电视机的兼容问题，使黑白电视机也能接受彩色电视信号**。

人眼对色度的敏感程度低于对亮度的敏感程度。主要原因是视网膜杆细胞多于视网膜锥细胞，其中视网膜杆细胞的作用就是识别亮度，视网膜锥细胞的作用就是识别色度。所以，眼睛对于亮度的分辨要比对颜色的分辨精细一些。

利用这个原理，可以把色度信息减少一点，人眼也无法查觉这一点。

所以，并不是每个像素点都需要包含了 Y、U、V 三个分量，根据不同的采样格式，可以每个 Y 分量都对应自己的 UV 分量，也可以几个 Y 分量共用 UV 分量。**相比 RGB，能够节约不少存储空间。**

## YUV 采样格式

YUV 图像的主流采样方式有如下三种：

- YUV 4:4:4 采样
- YUV 4:2:2 采样
- YUV 4:2:0 采样

### YUV 4:4:4

YUV 4:4:4 表示 Y、U、V 三分量采样率相同，即每个像素的三分量信息完整，都是 8bit，每个像素占用 3 个字节，这种采样方式与 RGB 图像大小是一样的。

如下图所示：

```java
四个像素为： [Y0 U0 V0] [Y1 U1 V1] [Y2 U2 V2] [Y3 U3 V3]
存放的码流为： Y0 U0 V0 Y1 U1 V1 Y2 U2 V2 Y3 U3 V3
映射出的像素点为：[Y0 U0 V0] [Y1 U1 V1] [Y2 U2 V2] [Y3 U3 V3]
```

### YUV 4:2:2 

YUV 4:2:2 表示

- YUV422 格式中每 4 点 Y 采样，有 2 点 U 和 2 点 V。色度信号的扫描线数量与亮度信号一样，但是每条扫描线上的色度采样点数只有亮度信号的一半。当 422 信号被解码时，缺失的色度采样，通常由一定的内插补点算法补充。
- YUV420 格式是色度分辨率最低的格式，也是 DVD 所使用的格式。无论横线还是纵向，色度信号的分辨率都只有亮度信号的一半。

![](https://raw.githubusercontent.com/zywudev/blog-source/master/image/yuv-format.png)



## YUV 两种存储格式

- planar：先连续存储所有像素点的 Y，紧接着存储所有像素点的 U，随后是所有像素点的 V。
- packed：每个像素点的 Y,U,V 是连续交错存储的。

假设一个分辨率为 8 X 4 的 YUV 图像，它们的存储格式如下图：

![](https://raw.githubusercontent.com/zywudev/blog-source/master/image/yuv420p.png)



![](https://raw.githubusercontent.com/zywudev/blog-source/master/image/yuv420sp.png)



