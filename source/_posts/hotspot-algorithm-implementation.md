---
title: HotSpot 虚拟机的算法实现
date: 2019-01-18 11:00:30
tags:
---

在 [JVM 中如何判断对象可以被回收](http://wuzhangyang.com/2019/01/12/how-do-jvm-kown-if-an-object-can-be-recycled/) 一文中，我们知道 HotSpot 虚拟机采取的是可达性分析算法。**即通过 GC Roots 枚举判定待回收的对象。**

但应用程序的方法区可能非常大，如果逐个检查引用，必然消耗太多时间。

此外，可达性分析工作必须是在一个确保一致性的内存快照中进行。为什么呢？因为如果在分析的过程中对象引用关系还在不断变化，分析结果的准确性就不能保证。这点导致在 GC 执行过程中，所有工作线程必须停顿，也就是所谓的 "Stop-The-World"。 

那么 HotSpot 是如何优化的呢？

## 准确式 GC

HotSpot 采取一种叫着“准确性 GC” 的技术，能够让虚拟机准确知道哪些地方存放着对象引用。

采取的办法是：使用一组称为 **OopMap** 的数据结构达到这个目的。

## OopMap

